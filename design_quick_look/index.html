<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Design Quick Look</title>
    
    <!-- Open Graph Meta Tags for Social Media Sharing -->
    <meta property="og:title" content="Design Quick Look">
    <meta property="og:description" content="A modern grid showcase">
    <meta property="og:url" content="https://projects.izel.website/design_quick_look">
    <meta property="og:type" content="website">
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Design Quick Look">
    <meta name="twitter:description" content="A modern grid showcase">
    
    <link rel="stylesheet" href="/design_quick_look/styles/design_quick_look.css">
</head>
<body>
    <!-- Fixed Top Navigation -->
    <nav class="top-nav">
        <p class="top-left">Izel Maras</p>
        <p class="top-right">Designer</p>
    </nav>

    <!-- Main Content -->
    <div class="page-container">
            <div class="grid-container">
                <div class="grid">
                    <div class="grid-item item-1" data-project="001_mypay_dial">
                        <img src="/design_quick_look/assets/thubnails/001_mypay_dial.png" alt="Mypay Dial" class="grid-image">
                    </div>
                    <div class="grid-item item-2" data-project="002_seismic_alarm">
                        <img src="/design_quick_look/assets/thubnails/002_seismic_alarm.png" alt="Seismic Alarm" class="grid-image">
                    </div>
                    <div class="grid-item item-3" data-project="003_instant_ask">
                        <img src="/design_quick_look/assets/thubnails/003_instant_ask.png" alt="Instant Ask" class="grid-image">
                    </div>
                    <div class="grid-item item-4" data-project="004_creator_tool">
                        <img src="/design_quick_look/assets/thubnails/004_creator_tool.png" alt="Creator Tool" class="grid-image">
                    </div>
                    <div class="grid-item item-5 span-2" data-project="005_roon_design_system">
                        <img src="/design_quick_look/assets/thubnails/005_roon_design_system.png" alt="Roon Design System" class="grid-image">
                    </div>
                    <div class="grid-item item-6" data-project="006_verizon_assistant">
                        <img src="/design_quick_look/assets/thubnails/006_verizon_assistant.png" alt="Verizon Assistant" class="grid-image">
                    </div>
                    <div class="grid-item item-7 span-2" data-project="007_moments">
                        <img src="/design_quick_look/assets/thubnails/007_moments.png" alt="Moments" class="grid-image">
                    </div>
                    <div class="grid-item item-8" data-project="008_multi_condition">
                        <img src="/design_quick_look/assets/thubnails/008_multi_condition.png" alt="Multi Condition" class="grid-image">
                    </div>
                    <div class="grid-item item-9" data-project="009_roon_illustrations">
                        <img src="/design_quick_look/assets/thubnails/009_roon_illustrations.png" alt="Roon Illustrations" class="grid-image">
                    </div>
                    <div class="grid-item item-10 span-2" data-project="010_verizon_data_visualization">
                        <img src="/design_quick_look/assets/thubnails/010_verizon_data_visualization.png" alt="Verizon Data Visualization" class="grid-image">
                    </div>
                    <div class="grid-item item-11" data-project="011_verizon_design_system">
                        <img src="/design_quick_look/assets/thubnails/011_verizon_design_system.png" alt="Verizon Design System" class="grid-image">
                    </div>
                    <div class="grid-item item-12" data-project="012_watchface">
                        <img src="/design_quick_look/assets/thubnails/011_interactive_work.png" alt="Watchface" class="grid-image">
                    </div>
                    <div class="grid-item item-13 span-2" data-project="013_desen">
                        <img src="/design_quick_look/assets/thubnails/013_desen.png" alt="Desen" class="grid-image">
                    </div>
                    <div class="grid-item item-14" data-project="014_interactive_work">
                        <img src="/design_quick_look/assets/thubnails/011_interactive_work.png" alt="Interactive Work" class="grid-image">
                    </div>
                    <div class="grid-item item-15" data-project="015_sketches">
                        <img src="/design_quick_look/assets/thubnails/014_sketches.png" alt="Sketches" class="grid-image">
                    </div>
                </div>
            </div>
    </div>

    <!-- Fixed Bottom Navigation -->
    <nav class="bottom-nav">
        <a class="bottom-nav__about" href="/design_quick_look/assets/resume_11142025.pdf" target="_blank" rel="noopener noreferrer">About</a>
        <a class="bottom-nav__link" href="https://www.izelmaras.com" target="_blank" rel="noopener noreferrer">izel.website</a>
    </nav>

    <!-- Modal -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <header class="modal-header">
                <span class="modal-header__title">Project</span>
                <div class="modal-header__center">
                    <div class="modal-floating-toggle"></div>
                </div>
                <button type="button" class="close" aria-label="Close modal">
                    <img src="/design_quick_look/assets/icons/Material icons/ic_close_48px.svg" alt="" class="close-icon">
                </button>
            </header>
            <div class="modal-body">
                <div class="modal-body__content"></div>
            </div>
            <div class="modal-progress">
                <div class="modal-progress__bar"></div>
            </div>
        </div>
    </div>

    <script>
        const modal = document.getElementById('modal');
        const modalContent = document.querySelector('.modal-content');
        const modalBody = document.querySelector('.modal-body');
        const closeBtn = document.querySelector('.close');
        const modalContentArea = document.querySelector('.modal-body__content');
        const headerTitle = document.querySelector('.modal-header__title');
        const floatingToggle = document.querySelector('.modal-floating-toggle');
        const progressTrack = document.querySelector('.modal-progress');
        const progressBar = document.querySelector('.modal-progress__bar');
        const gridItems = document.querySelectorAll('.grid-item[data-project]');
        const baseProjectPath = '/design_quick_look/assets/projects/';

                        const projectNames = {
            '001_mypay_dial': 'Mypay Dial',
            '002_seismic_alarm': 'Seismic Alarm',
            '003_instant_ask': 'Instant Ask',
            '004_creator_tool': 'Creator Tool',
            '005_roon_design_system': 'Roon Design System',
            '006_verizon_assistant': 'Verizon Assistant',
            '007_moments': 'Moments',
            '008_multi_condition': 'Multi Condition',
            '009_roon_illustrations': 'Roon Illustrations',
            '010_verizon_data_visualization': 'Verizon Data Visualization',
            '011_verizon_design_system': 'Verizon Design System',
            '012_watchface': 'Watchface',
            '013_desen': 'Desen',
            '014_interactive_work': 'Interactive Work',
            '015_sketches': 'Sketches'
        };

        let currentProject = null;
        let isDragging = false;
        let isLoading = false;
        let startX, startY, startLeft, startTop;

        const resetModalPosition = () => {
            modalContent.style.left = '';
            modalContent.style.top = '';
        };

        const setModalVisibility = (show) => {
            modal.style.display = show ? 'block' : 'none';
            document.body.style.overflow = show ? 'hidden' : 'auto';
            resetModalPosition();
        };

        const setHistoryState = (projectId, { replace = false } = {}) => {
            const url = new URL(window.location.href);
            if (projectId) {
                url.searchParams.set('project', projectId);
            } else {
                url.searchParams.delete('project');
            }

            if (replace) {
                history.replaceState(projectId ? { project: projectId } : {}, '', url);
            } else {
                history.pushState(projectId ? { project: projectId } : {}, '', url);
            }
        };

        const clearModalContent = () => {
            modalContentArea.innerHTML = '';
            currentProject = null;
            if (headerTitle) {
                headerTitle.textContent = 'Project';
            }
            if (floatingToggle) {
                floatingToggle.innerHTML = '';
                floatingToggle.classList.remove('is-active');
            }
            if (progressBar) {
                progressBar.style.transform = 'scaleX(0)';
            }
            if (progressTrack) {
                progressTrack.classList.remove('is-active');
            }
        };

        const showLoading = () => {
            modalContentArea.innerHTML = '<div class="modal-loading">Loading...</div>';
            if (headerTitle) {
                headerTitle.textContent = 'Loading';
            }
            if (floatingToggle) {
                floatingToggle.innerHTML = '';
                floatingToggle.classList.remove('is-active');
            }
            if (progressBar) {
                progressBar.style.transform = 'scaleX(0)';
            }
            if (progressTrack) {
                progressTrack.classList.remove('is-active');
            }
        };

        const showError = () => {
            modalContentArea.innerHTML = `
                <div class="modal-error">
                    <h3>Something went wrong</h3>
                    <p>We couldn\'t load that project. Please try again.</p>
                </div>
            `;
            if (headerTitle) {
                headerTitle.textContent = 'Load error';
            }
            if (floatingToggle) {
                floatingToggle.innerHTML = '';
                floatingToggle.classList.remove('is-active');
            }
            if (progressBar) {
                progressBar.style.transform = 'scaleX(0)';
            }
            if (progressTrack) {
                progressTrack.classList.remove('is-active');
            }
        };

        function updateProgress() {
            if (!progressBar) {
                return;
            }
            const scrollableHeight = modalBody.scrollHeight - modalBody.clientHeight;
            const ratio = scrollableHeight > 0 ? modalBody.scrollTop / scrollableHeight : 0;
            progressBar.style.transform = `scaleX(${ratio})`;
        }

        let projectsManifest = null;

        const loadManifest = async () => {
            if (projectsManifest) {
                return projectsManifest;
            }
            try {
                const response = await fetch(`${baseProjectPath}manifest.json`);
                if (response.ok) {
                    projectsManifest = await response.json();
                    return projectsManifest;
                }
            } catch (e) {
                console.error('Failed to load manifest:', e);
            }
            return {};
        };

        const loadProjectImages = async (projectId) => {
            const manifest = await loadManifest();
            const projectPath = `${baseProjectPath}${projectId}/`;
            const imageFiles = manifest[projectId] || [];
            
            return imageFiles
                .filter(filename => {
                    const ext = filename.toLowerCase().split('.').pop();
                    const isImage = ['png', 'jpg', 'jpeg', 'gif', 'webp'].includes(ext);
                    const isThumbnail = filename.toLowerCase().includes('thumbnail');
                    return isImage && !isThumbnail;
                })
                .map(filename => `${projectPath}${filename}`)
                .sort();
        };

        const loadProjectText = async (projectId) => {
            const projectPath = `${baseProjectPath}${projectId}/`;
            const textExtensions = ['txt', 'md', 'text'];
            const textFiles = ['description.txt', 'info.txt', 'readme.txt', 'description.md', 'info.md', 'readme.md'];
            
            for (const filename of textFiles) {
                try {
                    const response = await fetch(`${projectPath}${filename}`);
                    if (response.ok) {
                        const text = await response.text();
                        return text.trim();
                    }
                } catch (e) {
                    // File doesn't exist, continue
                }
            }
            
            return null;
        };

        const formatProjectDescription = (text, projectName) => {
            const lines = text.split('\n').filter(line => line.trim());
            let summary = '';
            let sectionsHTML = '';
            let currentSection = null;
            let currentContent = [];
            let isFirstLine = true;

            const sectionMap = {
                'Challenge': 'challenge',
                'Audience': 'audience',
                'Context': 'context',
                'Solution': 'solution',
                'Results': 'results',
                'Year': 'year',
                'Collaborators': 'collaborators',
                'Goals': 'goals'
            };

            const closeSection = () => {
                if (currentSection && currentContent.length > 0) {
                    const content = currentContent.join('').trim();
                    if (content) {
                        sectionsHTML += `<div class="description-section description-${currentSection}">`;
                        sectionsHTML += `<h3 class="description-section-title">${Object.keys(sectionMap).find(k => sectionMap[k] === currentSection)}</h3>`;
                        sectionsHTML += `<div class="description-section-content">${content}</div>`;
                        sectionsHTML += `</div>`;
                    }
                    currentContent = [];
                }
            };

            for (const line of lines) {
                const trimmed = line.trim();
                if (!trimmed) continue;

                // First line is the summary
                if (isFirstLine) {
                    summary = trimmed;
                    isFirstLine = false;
                    continue;
                }

                // Check if this is a section header
                const isSectionHeader = Object.keys(sectionMap).some(key => trimmed === key);
                
                if (isSectionHeader) {
                    closeSection();
                    currentSection = sectionMap[trimmed];
                } else if (currentSection) {
                    // Check if it's a bullet point
                    if (trimmed.startsWith('â€¢')) {
                        currentContent.push(`<p class="description-bullet">${trimmed.substring(1).trim()}</p>`);
                    } else {
                        currentContent.push(`<p class="description-paragraph">${trimmed}</p>`);
                    }
                }
            }

            closeSection();
            return {
                summary: summary ? `<div class="modal-project-summary">${summary}</div>` : '',
                sections: sectionsHTML ? `<div class="modal-project-description-wrapper"><div class="modal-project-description">${sectionsHTML}</div></div>` : ''
            };
        };

        const openModal = async (projectId, { skipHistory = false, replaceState = false } = {}) => {
            if (isLoading) {
                return;
            }

            isLoading = true;
            setModalVisibility(true);
            showLoading();

            try {
                const images = await loadProjectImages(projectId);
                
                if (images.length === 0) {
                    modalContentArea.innerHTML = `
                        <div class="modal-error">
                            <h3>No images available</h3>
                            <p>This project doesn't have any images yet.</p>
                        </div>
                    `;
                    if (headerTitle) {
                        headerTitle.textContent = projectNames[projectId] || projectId;
                    }
                    isLoading = false;
                    return;
                }

                const projectName = projectNames[projectId] || projectId;
                if (headerTitle) {
                    headerTitle.textContent = projectName;
                }

                const projectText = await loadProjectText(projectId);
                const imagesHTML = images.map(img => 
                    `<img src="${img}" alt="${projectName}" class="modal-project-image" loading="lazy">`
                ).join('');

                let contentHTML = '';
                if (projectText) {
                    const description = formatProjectDescription(projectText, projectName);
                    contentHTML += description.summary;
                }
                contentHTML += `<div class="modal-project-gallery">${imagesHTML}</div>`;
                if (projectText) {
                    const description = formatProjectDescription(projectText, projectName);
                    contentHTML += description.sections;
                }
                contentHTML += `<div class="description-navigation">
                    <button class="description-nav-btn description-nav-prev" id="desc-prev" aria-label="Previous section">
                        <img src="/design_quick_look/assets/icons/Material icons/ic_chevron_left_48px.svg" alt="" class="nav-icon">
                    </button>
                    <button class="description-nav-btn description-nav-next" id="desc-next" aria-label="Next section">
                        <img src="/design_quick_look/assets/icons/Material icons/ic_chevron_right_48px.svg" alt="" class="nav-icon">
                    </button>
                </div>`;

                modalContentArea.innerHTML = contentHTML;
                
                // Setup description navigation
                setupDescriptionNavigation();
                modalBody.scrollTop = 0;
                
                if (progressTrack) {
                    progressTrack.classList.add('is-active');
                }
                if (progressBar) {
                    progressBar.style.transform = 'scaleX(0)';
                }
                updateProgress();
                currentProject = projectId;

                if (!skipHistory) {
                    setHistoryState(projectId, { replace: replaceState });
                }
                if (replaceState && skipHistory) {
                    setHistoryState(projectId, { replace: true });
                }
            } catch (error) {
                console.error(error);
                showError();
            } finally {
                isLoading = false;
            }
        };

        const closeModal = ({ skipHistory = false, replaceState = false } = {}) => {
            if (modal.style.display !== 'block') {
                return;
            }

            setModalVisibility(false);
            clearModalContent();

            if (!skipHistory) {
                setHistoryState(null, { replace: replaceState });
            }
            if (replaceState && skipHistory) {
                setHistoryState(null, { replace: true });
            }
        };

        gridItems.forEach(item => {
            item.style.cursor = 'pointer';
            item.addEventListener('click', () => {
                const projectId = item.dataset.project;
                if (projectId) {
                    openModal(projectId);
                }
            });
        });

        modalBody.addEventListener('scroll', updateProgress);

        const setupDescriptionNavigation = () => {
            const scrollContainer = document.querySelector('.modal-project-description');
            const prevBtn = document.getElementById('desc-prev');
            const nextBtn = document.getElementById('desc-next');
            
            if (!scrollContainer || !prevBtn || !nextBtn) return;
            
            const updateButtons = () => {
                const scrollLeft = scrollContainer.scrollLeft;
                const scrollWidth = scrollContainer.scrollWidth;
                const clientWidth = scrollContainer.clientWidth;
                
                prevBtn.disabled = scrollLeft <= 0;
                nextBtn.disabled = scrollLeft >= scrollWidth - clientWidth - 1;
            };
            
            prevBtn.addEventListener('click', () => {
                scrollContainer.scrollBy({ left: -300, behavior: 'smooth' });
            });
            
            nextBtn.addEventListener('click', () => {
                scrollContainer.scrollBy({ left: 300, behavior: 'smooth' });
            });
            
            scrollContainer.addEventListener('scroll', updateButtons);
            updateButtons();
        };

        closeBtn.addEventListener('click', () => closeModal());

        window.addEventListener('click', (event) => {
            if (event.target === modal) {
                closeModal();
            }
        });

        window.addEventListener('resize', () => {
            if (modal.style.display === 'block' && !isDragging) {
                resetModalPosition();
            }
        });

        window.addEventListener('popstate', (event) => {
            const project = event.state && event.state.project ? event.state.project : new URL(window.location.href).searchParams.get('project');
            if (project && projectNames[project]) {
                openModal(project, { skipHistory: true, replaceState: true });
            } else {
                closeModal({ skipHistory: true, replaceState: true });
            }
        });

        // Drag functionality - Mouse
        modalContent.addEventListener('mousedown', function(e) {
            if (window.innerWidth > 768 && (e.target.classList.contains('modal-header') || e.target.classList.contains('close'))) {
                isDragging = true;
                startX = e.clientX;
                startY = e.clientY;
                startLeft = modalContent.offsetLeft;
                startTop = modalContent.offsetTop;
            }
        });

        document.addEventListener('mousemove', function(e) {
            if (isDragging) {
                e.preventDefault();
                modalContent.style.left = (startLeft + e.clientX - startX) + 'px';
                modalContent.style.top = (startTop + e.clientY - startY) + 'px';
            }
        });

        document.addEventListener('mouseup', function() {
            isDragging = false;
        });

        // Drag functionality - Touch (disabled on mobile for better scrolling)
        modalContent.addEventListener('touchstart', function(e) {
            if (window.innerWidth > 768 && (e.target.classList.contains('modal-header') || e.target.classList.contains('close'))) {
                isDragging = true;
                startX = e.touches[0].clientX;
                startY = e.touches[0].clientY;
                startLeft = modalContent.offsetLeft;
                startTop = modalContent.offsetTop;
            }
        }, { passive: true });

        document.addEventListener('touchmove', function(e) {
            if (isDragging && window.innerWidth > 768) {
                e.preventDefault();
                modalContent.style.left = (startLeft + e.touches[0].clientX - startX) + 'px';
                modalContent.style.top = (startTop + e.touches[0].clientY - startY) + 'px';
            }
        }, { passive: false });

        document.addEventListener('touchend', function() {
            isDragging = false;
        });

        // Resize functionality
        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeModal();
            }
        });

        // Initial load: open modal if URL includes project param
        const initialProject = new URL(window.location.href).searchParams.get('project');
        if (initialProject && projectNames[initialProject]) {
            openModal(initialProject, { skipHistory: true, replaceState: true });
        } else {
            history.replaceState({}, '', window.location.href);
        }
    </script>
</body>
</html>

